<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta charset="UTF-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.1/angular.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="js/menu.js"></script>
    <script src="js/app.js"></script>
    <link rel="stylesheet" href="css/home.css">
    <link rel="stylesheet" href="css/slider-menu.css">
    <link rel="stylesheet" href="css/font-face.css">
    <style>
        #content {
            padding: 0 !important;
        }
        #map-canvas {
            height:100%;
            position: inherit !important;
        }
    </style>
    <script>
        $(document).on('pageshow', '#homepage',function(e,data){
            $('#content').height(getRealContentHeight());
        });

        function getRealContentHeight() {
            var header = $.mobile.activePage.find("div[data-role='header']:visible");
            var footer = $.mobile.activePage.find("div[data-role='footer']:visible");
            var content = $.mobile.activePage.find("div[data-role='content']:visible:visible");
            var viewport_height = $(window).height();

            var content_height = viewport_height - header.outerHeight() - footer.outerHeight();
            if((content.outerHeight() - header.outerHeight() - footer.outerHeight()) <= viewport_height) {
                content_height -= (content.outerHeight() - content.height());
            }
            return content_height;
        }

        function initMap() {
            //Stations
            var fortLatlng = {lat: 6.9334923, lng: 79.8505064};
            var maradanaLatlng = {lat: 6.9294665, lng: 79.8651053};
            var slaveislandLatlng = {lat: 6.9230118, lng: 79.8489035};
            var bambaLatlng = {lat: 6.8830177, lng: 79.8807119};
            var kpLatlng = {lat: 6.8831291, lng: 79.8813752};
            //Places
            var gangaramayaLatlng = {lat: 6.916596, lng: 79.856522};

            var map = new google.maps.Map(document.getElementById('map-canvas'), {
                zoom: 15,
                center: gangaramayaLatlng
            });

            var markerFort = new google.maps.Marker({
                position: fortLatlng,
                map: map,
                title: 'Fort Railway Station',
                url: '#'
            });

            var markerMaradana = new google.maps.Marker({
                position: maradanaLatlng,
                map: map,
                title: 'Maradana Railway Station',
                url: '#'
            });

            var markerSlaveisland = new google.maps.Marker({
                position: slaveislandLatlng,
                map: map,
                title: 'Slave Island Railway Station',
                url: '#'
            });

            var markerBamba = new google.maps.Marker({
                position: bambaLatlng,
                map: map,
                title: 'Bambalapitiya Railway Station',
                url: '#'
            });

            var markerKp = new google.maps.Marker({
                position: kpLatlng,
                map: map,
                title: 'Kirillapone Railway Station',
                url: '#'
            });

            var markerGangaramaya = new google.maps.Marker({
                position: gangaramayaLatlng,
                map: map,
                title: 'Kirillapone Railway Station',
                url: 'placefacts-gangaramaya.html'
            });

            // Click event listeners
            markerFort.addListener('click', function() {
                map.setZoom(13);
                map.setCenter(markerFort.getPosition());
            });

            markerSlaveisland.addListener('click', function() {
                map.setZoom(17);
                map.setCenter(markerSlaveisland.getPosition());
            });

            markerGangaramaya.addListener('click', function() {
                window.location = markerGangaramaya.url;
            });
        }
    </script>
</head>
<body ng-app="railPaaraApp">

    <div data-role="page" id="homepage" class="ui-responsive-panel" ng-controller="logoutController">

        <!--Header-->
        <div data-role="header" class="header" data-position="fixed">
            <div data-role="controlgroup" data-type="horizontal" class="ui-btn-left" data-mini="true">
                <div id="menubuttonblock">
                    <a href="#menu"><img id="menubutton" src="images/buttons/icon-buttons/menu_button.png"/></a>
                </div>
            </div>
            <div id="logoblock">
                <img src="images/logos/header/home_header_logo.png"/>
            </div>
            <div data-role="controlgroup" data-type="horizontal" class="ui-btn-right" data-mini="true">
                <div id="backbuttonblock">
                    <a href=""><img id="backbutton" ng-click="logout()" src="images/buttons/icon-buttons/back_button.png"/></a>
                </div>
            </div>
        </div>

        <!-- Slide Menu Panel -->
        <div data-role="panel" id="menu" data-position="left" data-display="push" data-position-fixed="true"
             class="menupanel">
            <script>$(function(){$("#menu").load("menu.html");});</script>
        </div>

        <div data-role="content" id="content">
            <div class="search-button-wrapper">
                <a href=""><img src="images/buttons/icon-buttons/search_button_small.png"/></a>
            </div>
            <div id="map-canvas"></div>
        </div>

        <!--Footer-->
        <div data-role="footer" data-position="fixed" class="footer">
            <h1>©Railපාර 2016</h1>
        </div>

    </div>
    <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBU3AMoPc-GDFXZvZyN78-QM6-YJ11h91M&callback=initMap">
    </script>
</body>
</html>